<!DOCTYPE html>
<html>
<head>

<title>Fraud Detection Dashboard</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</head>

<body>

<h2>Fraud Detection Dashboard</h2>

<form>

Amount: <input type="number" id="amount"><br>
Old Balance Org: <input type="number" id="oldbalanceOrg"><br>
New Balance Orig: <input type="number" id="newbalanceOrig"><br>
Old Balance Dest: <input type="number" id="oldbalanceDest"><br>
New Balance Dest: <input type="number" id="newbalanceDest"><br>

<button type="button" onclick="predict()">Predict</button>

</form>

<h3 id="result"></h3>

<canvas id="chart" width="400" height="200"></canvas>

<script>

let fraudCount = 0;
let normalCount = 0;

let chart = new Chart(
    document.getElementById("chart"),
    {
        type: "pie",
        data: {
            labels: ["Fraud", "Normal"],
            datasets: [{
                data: [fraudCount, normalCount]
            }]
        }
    }
);

async function predict() {

    const data = {
        amount: parseFloat(amount.value),
        oldbalanceOrg: parseFloat(oldbalanceOrg.value),
        newbalanceOrig: parseFloat(newbalanceOrig.value),
        oldbalanceDest: parseFloat(oldbalanceDest.value),
        newbalanceDest: parseFloat(newbalanceDest.value)
    };

    const response = await fetch("/predict", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify(data)
    });

    const result = await response.json();

    document.getElementById("result").innerText =
        "Fraud: " + result.fraud +
        " Probability: " + result.probability;

    if(result.fraud)
        fraudCount++;
    else
        normalCount++;

    chart.data.datasets[0].data = [fraudCount, normalCount];
    chart.update();
}

</script>

</body>
</html>
